<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!--will scale to diff browser sizes-->
    <title>Gigl</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css">
    <style>
        section {
            margin: 0 auto;
            width: 80%;
            padding: 1em;
        }
    </style>
    <script>
        function sortTable(column, dataType) {
          var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
          table = document.querySelector("table");
          switching = true;
          dir = "asc"; // Set the initial sorting direction to ascending
      
          while (switching) {
            switching = false;
            rows = table.rows;
      
            for (i = 1; i < rows.length - 1; i++) {
              shouldSwitch = false;
              x = rows[i].getElementsByTagName("TD")[column];
              y = rows[i + 1].getElementsByTagName("TD")[column];
      
              // Determine if rows should switch place based on the data type
              if (dir == "asc") {
                if ((dataType === 'text' && x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) ||
                    (dataType === 'date' && new Date(x.innerHTML) > new Date(y.innerHTML))) {
                  shouldSwitch = true;
                  break;
                }
              } else if (dir == "desc") {
                if ((dataType === 'text' && x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) ||
                    (dataType === 'date' && new Date(x.innerHTML) < new Date(y.innerHTML))) {
                  shouldSwitch = true;
                  break;
                }
              }
            }
            if (shouldSwitch) {
              rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
              switching = true;
              switchcount++;
            } else {
              if (switchcount == 0 && dir == "asc") {
                dir = "desc";
                switching = true;
              }
            }
          }
        }
      </script>
      
      
      
</head>

<body>
    {% include 'header.html' %}
    <section>
        <h1>Make Another Search</h1>
        <!-- Update the form to use WTForms -->
        <form action="{{ url_for('search_results') }}" method="GET">
            <div class="flex space-x-10">
                <!-- Render the keyword field using WTForms -->
                {{ search_form.keyword(class_="border border-gray-200 p-2 w-full rounded-lg focus:outline-none focus:border-teal-500", placeholder="Search for any gig now!") }}
                
                <!-- Render the category select field using WTForms -->
                {{ search_form.category(class_="border border-gray-200 p-2 rounded-lg focus:outline-none focus:border-teal-500") }}
                
                <!-- Render the submit button using WTForms -->
                {{ search_form.submit(class_="p-2 w-auto rounded-lg bg-indigo-200") }}
            </div>
        </form>
    </section>
    
    <section>
        <h2>Search Results</h2>
        <div class="overflow-auto rounded-lg">
            <table class="w-full">
                <thead class="bg-gray-200 border-b-2 border-gray-200">
                <tr>
                    <th class="p-3 text-sm font-semibold tracking-wide text-left cursor-pointer">Gig Title</th>
                    <th class="p-3 text-sm font-semibold tracking-wide text-left cursor-pointer" onclick="sortTable(1, 'date')">Posted On</th>
                    <th class="p-3 text-sm font-semibold tracking-wide text-left cursor-pointer" onclick="sortTable(2, 'date')">Start Date</th>
                    <th class="p-3 text-sm font-semibold tracking-wide text-left cursor-pointer" onclick="sortTable(3, 'date')">End Date</th>
                    <th class="p-3 text-sm font-semibold tracking-wide text-left cursor-pointer">Category</th>
                </tr>
                </thead>
                
                <tbody class="divide-y divide-gray-150">
                    {% for gig in mygigs %}
                            <tr class="bg-gray-100">
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap"><a href="{{ url_for('details', id=gig.get_gigID()) }}" class="font-bold text-blue-500 hover:underline">{{ gig.get_title() }}</a></td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_post_date() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_fromdate() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_til_date() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">
                                    {% if gig.get_category() == 'teaching' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-blue-800 bg-blue-200 rounded-lg bg-opacity-50">
                                        Teaching
                                    </span>
                                    {% elif gig.get_category() == 'research' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-green-800 bg-green-200 rounded-lg bg-opacity-50">
                                        Research
                                    </span>
                                    {% elif gig.get_category() == 'technical' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-yellow-800 bg-yellow-200 rounded-lg bg-opacity-50">
                                        Technical
                                    </span>
                                    {% elif gig.get_category() == 'writing' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-red-800 bg-red-200 rounded-lg bg-opacity-50">
                                        Writing
                                    </span>
                                    {% elif gig.get_category() == 'graphic_design' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-purple-800 bg-purple-200 rounded-lg bg-opacity-50">
                                        Graphic Design
                                    </span>
                                    {% elif gig.get_category() == 'photography_film' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-pink-800 bg-pink-200 rounded-lg bg-opacity-50">
                                        Photography/Film
                                    </span>
                                    {% elif gig.get_category() == 'events' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-indigo-800 bg-indigo-200 rounded-lg bg-opacity-50">
                                        Events
                                    </span>
                                    {% elif gig.get_category() == 'marketing' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-gray-800 bg-gray-200 rounded-lg bg-opacity-50">
                                        Marketing
                                    </span>
                                    {% elif gig.get_category() == 'administrative' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-blue-800 bg-blue-200 rounded-lg bg-opacity-50">
                                        Administrative
                                    </span>
                                    {% elif gig.get_category() == 'volunteer' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-green-800 bg-green-200 rounded-lg bg-opacity-50">
                                        Volunteer
                                    </span>
                                    {% elif gig.get_category() == 'fitness' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-yellow-800 bg-yellow-200 rounded-lg bg-opacity-50">
                                        Fitness
                                    </span>
                                    {% elif gig.get_category() == 'other' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-red-800 bg-red-200 rounded-lg bg-opacity-50">
                                        Other
                                    </span>
                                </td>
                            </tr>
                        {% else %}
                            <tr class="bg-white">
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap"><a href="{{ url_for('details', id=gig.get_gigID()) }}" class="font-bold text-blue-500 hover:underline">#{{ gig.get_gigID() }}</a></td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_title() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_description() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_post_date() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_fromdate() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">{{ gig.get_til_date() }}</td>
                                <td scope="row" class="p-3 text-sm text-gray-700 whitespace-nowrap">
                                    {% if gig.get_category() == 'teaching' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-blue-800 bg-blue-200 rounded-lg bg-opacity-50">
                                        Teaching
                                    </span>
                                    {% elif gig.get_category() == 'research' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-green-800 bg-green-200 rounded-lg bg-opacity-50">
                                        Research
                                    </span>
                                    {% elif gig.get_category() == 'technical' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-yellow-800 bg-yellow-200 rounded-lg bg-opacity-50">
                                        Technical
                                    </span>
                                    {% elif gig.get_category() == 'writing' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-red-800 bg-red-200 rounded-lg bg-opacity-50">
                                        Writing
                                    </span>
                                    {% elif gig.get_category() == 'graphic_design' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-purple-800 bg-purple-200 rounded-lg bg-opacity-50">
                                        Graphic Design
                                    </span>
                                    {% elif gig.get_category() == 'photography_film' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-pink-800 bg-pink-200 rounded-lg bg-opacity-50">
                                        Photography/Film
                                    </span>
                                    {% elif gig.get_category() == 'events' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-indigo-800 bg-indigo-200 rounded-lg bg-opacity-50">
                                        Events
                                    </span>
                                    {% elif gig.get_category() == 'marketing' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-gray-800 bg-gray-200 rounded-lg bg-opacity-50">
                                        Marketing
                                    </span>
                                    {% elif gig.get_category() == 'administrative' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-blue-800 bg-blue-200 rounded-lg bg-opacity-50">
                                        Administrative
                                    </span>
                                    {% elif gig.get_category() == 'volunteer' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-green-800 bg-green-200 rounded-lg bg-opacity-50">
                                        Volunteer
                                    </span>
                                    {% elif gig.get_category() == 'fitness' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-yellow-800 bg-yellow-200 rounded-lg bg-opacity-50">
                                        Fitness
                                    </span>
                                    {% elif gig.get_category() == 'other' %}
                                    <span class="p-2 text-xs font-medium uppercase tracking-wider text-red-800 bg-red-200 rounded-lg bg-opacity-50">
                                        Other
                                    </span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
    
</body>

</html>